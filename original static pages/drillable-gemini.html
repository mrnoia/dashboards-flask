<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Drill-Down Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <style>
        body { background: #f8f9fa; padding: 20px; }
        .card { border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        #back-btn { display: none; } /* Hidden until we drill down */
    </style>
</head>
<body>

<div class="container">
    <div class="card p-4">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h4 id="chart-title">Global Sales by Region</h4>
            <button id="back-btn" class="btn btn-sm btn-outline-secondary" onclick="resetChart()">‚Üê Back to Regions</button>
        </div>
        <div id="drilldown-chart"></div>
    </div>
</div>

<script>
    // 1. DATA STRUCTURE (Usually comes from your JSON API)
    const storeData = {
        regions: {
            categories: ['North America', 'Europe', 'Asia'],
            data: [400, 300, 500]
        },
        cities: {
            'North America': { categories: ['New York', 'LA', 'Chicago'], data: [150, 150, 100] },
            'Europe': { categories: ['London', 'Paris', 'Berlin'], data: [120, 100, 80] },
            'Asia': { categories: ['Tokyo', 'Seoul', 'Beijing'], data: [200, 150, 150] }
        }
    };

    // 2. INITIAL CHART OPTIONS
    const options = {
        chart: {
            type: 'bar',
            height: 380,
            events: {
                // THE DRILL-DOWN LOGIC
                dataPointSelection: (event, chartContext, config) => {
                    const regionIndex = config.dataPointIndex;
                    const regionName = storeData.regions.categories[regionIndex];
                    
                    if (storeData.cities[regionName]) {
                        drillDown(regionName);
                    }
                }
            }
        },
        series: [{ name: 'Sales', data: storeData.regions.data }],
        xaxis: { categories: storeData.regions.categories },
        colors: ['#008FFB'],
        plotOptions: { bar: { distributed: true } }
    };

    const chart = new ApexCharts(document.querySelector("#drilldown-chart"), options);
    chart.render();

    // 3. DRILL-DOWN FUNCTION
    function drillDown(region) {
        const cityData = storeData.cities[region];
        
        chart.updateOptions({
            xaxis: { categories: cityData.categories },
            title: { text: `Sales in ${region}` },
            colors: ['#00E396'] // Change color to signify "Detail View"
        });

        chart.updateSeries([{ name: 'City Sales', data: cityData.data }]);
        
        document.getElementById('back-btn').style.display = 'block';
        document.getElementById('chart-title').innerText = `Details: ${region}`;
    }

    // 4. RESET FUNCTION
    function resetChart() {
        chart.updateOptions({
            xaxis: { categories: storeData.regions.categories },
            colors: ['#008FFB']
        });
        chart.updateSeries([{ name: 'Sales', data: storeData.regions.data }]);
        
        document.getElementById('back-btn').style.display = 'none';
        document.getElementById('chart-title').innerText = "Global Sales by Region";
    }
</script>
</body>
</html>